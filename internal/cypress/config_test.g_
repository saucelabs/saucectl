package cypress

import (
	"github.com/stretchr/testify/assert"
	"os"
	"testing"
)

func TestFromFile(t *testing.T) {
	fileName := "./test-config-load.yml"
	defer func() {
		// Cleanup created file
		os.Remove(fileName)
		os.Remove("./cypress.json")
		os.Remove("cypress")
	}()

	f, _ := os.Create(fileName)
	f.WriteString("apiVersion: v1alpha\nkind: cypress\n")
	f.WriteString("cypress:\n  version: 5.6.0\n  configFile: cypress.json")
	f.Close()

	f, _ = os.Create("./cypress.json")
	f.WriteString("{}")
	f.Close()

	os.Mkdir("cypress", 0755)

	p, err := FromFile(fileName)
	assert.NotNil(t, p)
	assert.Nil(t, err)
}